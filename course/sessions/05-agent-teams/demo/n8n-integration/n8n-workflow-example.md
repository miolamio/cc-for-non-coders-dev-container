# Пример: еженедельный отчёт по расписанию

Каждый понедельник в 9:00 n8n запускает Claude Code, который собирает еженедельный отчёт из нескольких файлов и отправляет результат в Telegram.

## Сценарий

В компании есть папка `/data/weekly/`, куда менеджеры складывают файлы за неделю:
- `sales.csv` -- продажи
- `expenses.csv` -- расходы
- `tasks.md` -- выполненные и просроченные задачи
- `kpi.json` -- ключевые метрики

Каждый понедельник в 9:00 нужно собрать из этих файлов сводку и отправить руководителю.

## Ноды в n8n

### 1. Schedule Trigger

Настройка: каждый понедельник, 09:00, часовой пояс Europe/Moscow.

### 2. Execute Command

Команда:

```bash
cd /projects/company-reports && claude -p "Прочитай файлы в папке /data/weekly/: sales.csv, expenses.csv, tasks.md, kpi.json. Собери еженедельный отчёт по шаблону из CLAUDE.md. Сохрани результат в /data/weekly/report-$(date +%Y-%m-%d).md"
```

Что здесь происходит:
- `cd /projects/company-reports` -- переход в папку проекта, где лежит CLAUDE.md с шаблоном отчёта
- `claude -p "..."` -- запуск Claude Code в неинтерактивном режиме
- Claude читает 4 файла, собирает отчёт по шаблону и сохраняет его с датой в имени

### 3. Read File

Читает сгенерированный файл `report-2026-03-10.md` (дата подставляется динамически).

### 4. Telegram (отправка сообщения)

Отправляет содержимое отчёта в Telegram-чат руководителя или рабочий канал.

## Что получится

Каждый понедельник руководитель получает в Telegram сообщение вида:

```
Еженедельный отчёт: 3–9 марта 2026

Продажи: 2.4 млн ₽ (на 12% выше прошлой недели)
Новых клиентов: 8
Средний чек: 48 000 ₽

Расходы: 890 тыс. ₽
  Маркетинг: 340 тыс.
  ФОТ: 420 тыс.
  Прочее: 130 тыс.

Задачи: 14 выполнено, 3 просрочено
  Просроченные:
  - Подготовить КП для "Ромашка" (срок: 7 марта, ответственный: Алексей)
  - Обновить прайс-лист (срок: 5 марта, ответственный: Мария)
  - Отправить акт сверки "ТехноЛайн" (срок: 6 марта, ответственный: Дмитрий)

KPI:
  Конверсия лидов: 17% (цель: 20%)
  Время ответа на заявку: 2.1 часа (цель: 1 час)
  NPS: 42 (цель: 50)
```

Руководитель видит сводку, не открывая ни одного файла. Если что-то требует внимания (просроченные задачи, падение конверсии), это видно сразу.

## Другие варианты использования

Тот же подход работает для любых регулярных задач:

- **Ежедневный дайджест новостей.** n8n по утрам запускает Claude Code с MCP-сервером Tavily. Claude ищет новости по ключевым словам, фильтрует, собирает сводку, отправляет в Telegram.
- **Проверка данных.** Каждый вечер Claude проверяет выгрузку из CRM на дубли и ошибки, формирует список для исправления.
- **Напоминание о дедлайнах.** n8n каждое утро запускает Claude, который читает файл с задачами и отправляет персональные напоминания тем, у кого дедлайн сегодня или завтра.

## Как попробовать самостоятельно

1. Установить n8n: `npm install -g n8n` или через Docker
2. Запустить: `n8n start`
3. Открыть http://localhost:5678
4. Создать workflow с нодами Schedule Trigger + Execute Command
5. В Execute Command указать команду `claude -p "ваш промпт"`
6. Протестировать вручную (кнопка Execute Workflow), потом включить расписание
