# Claude Code: контейнер рабочей среды курса

Docker-контейнер для курса «Claude Code: суперсила для НЕпрограммистов» (Automatica, сезон 1). Каждый студент получает в браузере изолированную среду: VS Code, терминал с Claude Code CLI и файловый менеджер.

## Что внутри

Один контейнер, три сервиса за общим порталом входа:

```
Браузер → :8080 (auth-gateway.py)
              ├─ /ide/   → code-server (VS Code в браузере)
              └─ /files/ → File Browser (файловый менеджер)
```

Студент логинится один раз и получает доступ ко всему.

### Что установлено

- **Claude Code CLI** — основной инструмент курса.
- **19 Skills** — создание документов (DOCX, PPTX, XLSX, PDF), дизайн, автоматизация браузера и др.
- **LibreOffice** — конвертация офисных форматов.
- **Playwright + Chromium** — управление браузером из скриптов.
- **Pandoc, Tesseract OCR, FFmpeg** — конвертация и обработка файлов.
- **Python-библиотеки** — pandas, matplotlib, pdfplumber, reportlab, openpyxl и др.
- **28 демо-проектов** — готовые примеры по всем 5 сессиям курса.

### Архитектура

| Компонент | Порт | Описание |
|-----------|------|----------|
| auth-gateway.py | 8080 (внешний) | Python-прокси с cookie-авторизацией, единая точка входа |
| code-server | 8081 (внутренний) | VS Code в браузере, без собственной авторизации |
| File Browser | 9090 (внутренний) | Файловый менеджер, noauth — авторизация через gateway |

## Быстрый старт

### 1. Клонировать и настроить

```bash
git clone git@github.com:miolamio/cc-for-non-coders-dev-container.git
cd cc-for-non-coders-dev-container
cp .env.example .env
```

Отредактировать `.env` — как минимум указать API-ключ:

```env
PASSWORD=student-2026
GLM_API_KEY=ваш-ключ-от-z-ai
```

### 2. Собрать и запустить

```bash
./run.sh
```

Скрипт скопирует курсовые материалы в build-контекст, соберёт Docker-образ и запустит контейнер.

### 3. Открыть в браузере

```
http://localhost:8080
```

Ввести пароль из `.env` — откроется VS Code с материалами курса.

## Управление

```bash
# Остановить контейнер
docker compose down

# Остановить и удалить данные студента
docker compose down -v

# Посмотреть логи
docker compose logs -f
```

## Переключение API-ключей

Контейнер поддерживает два ключа — основной и резервный. Если основной упирается в лимиты, преподаватель переключает на резервный:

```bash
# Внутри контейнера (в терминале code-server):
./switch-api-key.sh backup    # переключить на резервный
./switch-api-key.sh primary   # вернуть основной
```

После переключения перезапустите Claude Code (`Ctrl+C`, затем `claude`).

## Структура файлов

```
├── Dockerfile              # Сборка образа: Ubuntu 22.04 + все зависимости
├── docker-compose.yml      # Конфигурация контейнера и переменных окружения
├── entrypoint.sh           # Запуск сервисов, генерация .env для Claude Code
├── auth-gateway.py         # Python HTTP-прокси с авторизацией (~300 строк)
├── login.html              # Страница входа (тёмная тема, брендинг)
├── code-server-settings.json # Настройки VS Code (тёмная тема, автосохранение)
├── claude-settings.json    # Разрешения Claude Code (белый список команд)
├── run.sh                  # Сборка и запуск одной командой
├── .env.example            # Шаблон переменных окружения
├── course/                 # Материалы курса (сессии, демо-проекты, README)
└── skills/                 # 19 Skills для Claude Code
```

## Production

Контейнер собран для локальной разработки и тестирования. Для деплоя на сервер (один контейнер на студента) есть отдельный provision-скрипт с Nginx и Let's Encrypt — см. `infra/` в основном репозитории курса.

## Лицензия

Внутренний проект Automatica. Курсовые материалы не для публичного распространения.
